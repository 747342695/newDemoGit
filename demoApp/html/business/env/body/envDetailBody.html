<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"/>
    <title>环境详情</title>
    <!--<script src="../../../script/jquery-3.1.1.min.js"></script>-->
    <!--<script src="../../../script/mui.js"></script>-->
    <link href="../../../../css/mui.css" rel="stylesheet"/>
    <link href="../../../../css/layout.css" rel="stylesheet"/>
    <link href="../../../../css/envDetail.css" rel="stylesheet"/>
    <style>
        .weathbg{ font-size:18px;line-height: 24px;}
        .weathbg p{font-size: 16px;}
    </style>
</head>
<body>
<!--<header class="mui-bar-nav mui-bar-transparent" id="topbar" style="display: none">-->
<!--<a class="mui-icon mui-icon-left-nav mui-pull-left" onclick="APIUtils.goBeforePage()"></a>-->
<!--<h1 class="mui-title">环境详情</h1>-->
<!--</header>-->
<!--<div style="height:0px;"></div>-->
<div class="ev_top flex-col v-center h-center">
    <div class="weathbg flex-col v-center h-center" style="flex-direction: column;">
        <p style="font-size: 24px;" id="pm25">0</p>
        <p>ug/m3</p>
    </div>
    <div onclick="APIUtils.goToPageByWindow('historyWeather','../historyWeather.html',api.pageParam)">
        <div class="historyWeather">历史天气</div>
    </div>
</div>
<div class="mui-col-sm-4 mui-col-xs-4 fl">
    <div class="ev_grid">
        <div class="mui-col-sm-6 mui-col-xs-6 fl">
            <div class="ev_img v-center  flex-col"><img src="../../../../image/thermometer.png" width="20px"></div>
            <div class="ev_text" id="temperature">0</div>
        </div>
        <div class="mui-col-sm-6 mui-col-xs-6 fl">
            <div class="ev_text tr">温度</div>
            <div class="ev_text tr">℃</div>
        </div>
        <div class="clear"></div>
    </div>
</div>
<div class="mui-col-sm-4 mui-col-xs-4 fl">
    <div class="ev_grid">
        <div class="mui-col-sm-6 mui-col-xs-6 fl">
            <div class="ev_img v-center flex-col"><img src="../../../../image/waterdroplets.png" width="25px"></div>
            <div class="ev_text" id="humidity">0</div>
        </div>
        <div class="mui-col-sm-6 mui-col-xs-6 fl">
            <div class="ev_text tr" >湿度</div>
            <div class="ev_text tr">%</div>
        </div>
        <div class="clear"></div>
    </div>
</div>
<div class="mui-col-sm-4 mui-col-xs-4 fl">
    <div class="ev_grid">
        <div class="mui-col-sm-6 mui-col-xs-6 fl">
            <div class="ev_img v-center flex-col"><img src="../../../../image/windspeed.png" width="30px"></div>
            <div class="ev_text" id="windSpeed">0</div>
        </div>
        <div class="mui-col-sm-6 mui-col-xs-6 fl">
            <div class="ev_text tr">风速</div>
            <div class="ev_text tr">m/s</div>
        </div>
        <div class="clear"></div>
    </div>
</div>
<div class="mui-col-sm-4 mui-col-xs-4 fl">
    <div class="ev_grid">
        <div class="mui-col-sm-6 mui-col-xs-6 fl">
            <div class="ev_img v-center flex-col"><img src="../../../../image/PM25.png" width="20px"></div>
            <div class="ev_text" id="windDirection">0</div>
        </div>
        <div class="mui-col-sm-6 mui-col-xs-6 fl">
            <div class="ev_text tr">风向</div>
            <div class="ev_text tr">°</div>
        </div>
        <div class="clear"></div>
    </div>
</div>
<div class="mui-col-sm-4 mui-col-xs-4 fl">
    <div class="ev_grid">
        <div class="mui-col-sm-6 mui-col-xs-6 fl">
            <div class="ev_img v-center flex-col"><img src="../../../../image/PM10.png" width="25px"></div>
            <div class="ev_text" id="noise">0</div>
        </div>
        <div class="mui-col-sm-6 mui-col-xs-6 fl">
            <div class="ev_text tr">噪音</div>
            <div class="ev_text tr">db</div>
        </div>
        <div class="clear"></div>
    </div>
</div>
<div class="mui-col-sm-4 mui-col-xs-4 fl">
    <div class="ev_grid" style="padding-right:7px">
        <div class="mui-col-sm-5 mui-col-xs-5 fl">
            <div class="ev_img v-center flex-col"><img src="../../../../image/noise.png" width="30px"></div>
            <div class="ev_text" id="pm10">0</div>
        </div>
        <div class="mui-col-sm-7 mui-col-xs-7 fl">
            <div class="ev_text tr">PM10</div>
            <div class="ev_text tr">ug/m3</div>
        </div>
        <div class="clear"></div>
    </div>
</div>

<div class="ev_bottom flex-col h-center v-center" style="flex-direction: column;margin-bottom: 40px">
    <p><img src="../../../../image/pengling2.png" style="width: 15px"></p>
    <p>喷淋</p>
</div>
<script type="text/javascript" src="../../../../script/api.js"></script>
<script type="text/javascript" src="../../../../script/dot.min.js"></script>
<script type="text/javascript" src="../../../../script/js/APIUtils.js"></script>
<script type="text/javascript" src="../../../../script/js/business/business-env.js"></script>
<script type="text/javascript" src="../../../../script/mui.js"></script>
<script>
    // var winWidth = document.body.clientWidth;
    // if(winWidth < 375) {
    //     var style = document.createElement("style");
    //     style.type = "text/css";
    //     try{
    //         style.appendChild(document.createTextNode(".ev_text{font-size:14px};"));
    //     }catch(ex){
    //         style.styleSheet.cssText = ".ev_text{font-size:14px};";//针对IE
    //     }
    //     var head = document.getElementsByTagName("head")[0];
    //     head.appendChild(style);
    //     // document.getElementById("pm10").style.fontSize="12px";
    //     // document.getElementById("pm10-text").style.fontSize="14px";
    //     // document.getElementById("ugm3").style.fontSize="12px";
    // }
    apiready = function () {
        $api.fixStatusBar($api.dom('header'));
        // 获取屏幕宽度 自适应字体大小
        var winWidth = api.winWidth;
        if(winWidth < 375) {
            var style = document.createElement("style");
            style.type = "text/css";
            try{
                style.appendChild(document.createTextNode(".ev_text{font-size:14px};"));
            }catch(ex){
                style.styleSheet.cssText = ".ev_text{font-size:14px};";//针对IE
            }
            var head = document.getElementsByTagName("head")[0];
            head.appendChild(style);
            // document.getElementById("pm10").style.fontSize="12px";
            // document.getElementById("pm10-text").style.fontSize="14px";
            // document.getElementById("ugm3").style.fontSize="12px";
        }
        // 查询今天的天气
        getTodayWeather();
    };

    // 查询今天的天气
    function getTodayWeather() {
        APIUtils.showProgress('提示','正在加载中');
        envModule.getTodayWeather({projectId: api.pageParam.projectId}, function (ret, err) {
            APIUtils.hideProgress();
            if(!APIUtils.errorCatch(err)){
                return ;
            }
            if(ret['object']==null || ret['object']==undefined){
                mui.alert('环境设备暂未接入该项目', '抱歉', function() {
                    APIUtils.goBeforePage();
                });
                return;
            }
            // 设置今日天气
            $api.byId("pm25").innerHTML = ret['object'].pm25;
            $api.byId("temperature").innerHTML = ret['object'].temperature;
            $api.byId("humidity").innerHTML = ret['object'].humidity;
            $api.byId("windSpeed").innerHTML = ret['object'].windSpeed;
            $api.byId("windDirection").innerHTML = ret['object'].windDirection;
            $api.byId("noise").innerHTML = ret['object'].noise;
            $api.byId("pm10").innerHTML = ret['object'].pm10;
        })
    }
</script>
</body>

</html>