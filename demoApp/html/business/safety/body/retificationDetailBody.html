<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <title>安全整改详情</title>
    <link href="../../../../css/mui.min.css" rel="stylesheet" />
    <link href="../../../../css/layout.css" rel="stylesheet" />
    <link href="../../../../css/siteDetail.css" rel="stylesheet" />
</head>

<body>
<header class="mui-bar-nav mui-bar-transparent"style="display: none;">
    <a class="mui-icon mui-icon-left-nav mui-pull-left" onclick="APIUtils.goBeforePage()"></a>
    <h1 class="mui-title">安全整改详情</h1>
</header>
<!--<div style="height:44px;"></div>-->
<!--for start-->
<div class="onellinelist f15">
    <div class="topcircle">
        <div class="toplinebg">
        </div>
    </div>

    <div class="clear"></div>
    <div class="leftboder">
        <div class="inforTittle">
            <span>基本信息</span>
            <div class="clear"></div>
        </div>
        <ul>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">编号:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="rectifyCode">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">检查日期:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="checkDate">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">安全监督科/员:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="staffName">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">项目编号:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="projectCode">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">项目名称:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="projectName">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">施工单位:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="constructionUnit">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">施工单位负责人:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="constructionUnitStaffName">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">建设单位:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="developmentUnit">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">建设单位负责人:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="developmentUnitStaffName">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">监理单位:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="supervisor">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">监理单位负责人:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="supervisorStaffName">

                </div>
                <div class="clear"></div>
            </li>

            <!--<li>-->
                <!--<div class="mui-col-sm-5 mui-col-xs-5 fl">-->
                    <!--<span class="pl10 fblue2">负责人:</span>-->
                <!--</div>-->
                <!--<div class="mui-col-sm-7 mui-col-xs-7 fl" id="staffName">-->

                <!--</div>-->
                <!--<div class="clear"></div>-->
            <!--</li>-->
        </ul>
    </div>
</div>
<!--for end-->
<!--for start-->
<div class="onellinelist f15" style="margin-bottom: 42px;">
    <div class="topcircle">
        <div class="toplinebg">
        </div>
    </div>

    <div class="clear"></div>
    <div class="leftboder">
        <div class="inforTittle">
            <span>检查情况</span>
            <div class="clear"></div>
        </div>
        <ul>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">检查类型:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="rectifyType">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">问题分类:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="checkProject">

                </div>
<!--                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="classificationCodeText">-->

<!--                </div>-->
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">检查内容:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="checkResult">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">安全隐患:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="title">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">通知书类型:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="noticeTypeText">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">通知书编号:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="f5">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">限期整改时间:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7 fl" id="rectifyTime">

                </div>
                <div class="clear"></div>
            </li>
            <li>
                <div class="mui-col-sm-5 mui-col-xs-5 fl">
                    <span class="pl10 fblue2">整改措施/要求:</span>
                </div>
                <div class="mui-col-sm-7 mui-col-xs-7  fl" id="rectifyOpinion">

                </div>
                <div class="clear"></div>
            </li>
            <li id="imgDiv">
            </li>
        </ul>
    </div>

</div>
<!--for end-->
<script id="imgDot" type="text/x-dot-template">
    {{ for(var x in it) { }}
    <div class="mui-col-xs-6 mui-col-sm-6 fl tc" style="padding-left:5px;" >
    <img name="fileImg" src="{{= it[x].filepath }}" onerror="APIUtils.noFind()"
          width="{{= it[x].wh}}" height="{{= it[x].wh}}" onclick="APIUtils.openPhotoBrowser(null, '{{=x}}', this.name)"/>
    </div>
    {{if(x%2!=0) { }}
    <div class='clear'></div>
    {{ } }}
    {{ } }}
</script>
<script type="text/javascript" src="../../../../script/api.js"></script>
<script type="text/javascript" src="../../../../script/js/APIUtils.js"></script>
<script type="text/javascript" src="../../../../script/dot.min.js"></script>
<script type="text/javascript" src="../../../../script/js/business/business-supervision.js"></script>
<script type="text/javascript">
    // 图片固定宽、高度
    var widthAndHeight;
    apiready = function() {
        $api.fixStatusBar( $api.dom('header'));
        var pageParam = api.pageParam;
        initDeciceDetail(pageParam.id);

        // 获取屏幕宽度  样式边距34  第二张图片右边距10
        var winWidth = api.winWidth * 0.97 - 34 - 10;
        widthAndHeight = winWidth/2;
    };

    //加载安全整改详细信息
    function initDeciceDetail(id){
        APIUtils.showProgress("提示", "正在加载中....");
        superModule.getRectificationDetail(id, function(ret, err) {
            APIUtils.hideProgress();
            // 判断请求是否错误
            if (!APIUtils.errorCatch(err)) {
                return;
            }
            var data = ret.object;
            // 设置dom元素内容
            $api.dom('#rectifyCode').innerHTML = data.rectifyCode == null ? "" : data.rectifyCode.replace(/<.*?>/g,"");//整改编号
            $api.dom('#checkDate').innerHTML = data.checkDate == null ? "" : new Date(data.checkDate).Format("yyyy-MM-dd");//检查日期
            $api.dom('#staffName').innerHTML = data.staffName == null ? "" : data.staffName.replace(/<.*?>/g,"");//负责人
            $api.dom('#projectCode').innerHTML = data.projectCode == null ? "" : data.projectCode.replace(/<.*?>/g,"");//项目编号
            $api.dom('#projectName').innerHTML = data.projectName == null ? "" : data.projectName.replace(/<.*?>/g,"");//项目名称
            // $api.dom('#checkStaffName').innerHTML = data.checkStaffName == null ? "" : data.checkStaffName.replace(/<.*?>/g,"");//安全监督员
            $api.dom('#constructionUnit').innerHTML = data.constructionUnit == null ? "" : data.constructionUnit.replace(/<.*?>/g,"");//施工单位
            $api.dom('#constructionUnitStaffName').innerHTML = data.constructionUnitStaffName == null ? "" : data.constructionUnitStaffName.replace(/<.*?>/g,"");//施工单位负责人
            $api.dom('#developmentUnit').innerHTML = data.developmentUnit == null ? "" : data.developmentUnit.replace(/<.*?>/g,"");//建设单位
            $api.dom('#developmentUnitStaffName').innerHTML = data.developmentUnitStaffName == null ? "" : data.developmentUnitStaffName.replace(/<.*?>/g,"");//建设单位负责人
            $api.dom('#supervisor').innerHTML = data.supervisor == null ? "" : data.supervisor.replace(/<.*?>/g,"");//监理单位
            $api.dom('#supervisorStaffName').innerHTML = data.supervisorStaffName == null ? "" : data.supervisorStaffName.replace(/<.*?>/g,"");//监理单位负责人
            $api.dom('#rectifyType').innerHTML = data.rectifyType == null ? "" : data.rectifyType.replace(/<.*?>/g,"");//整改类型
            $api.dom('#checkProject').innerHTML = data.checkProject == null ? "" : data.checkProject.replace(/<.*?>/g,"");//问题分类
            // $api.dom('#classificationCodeText').innerHTML = data.classificationCodeText == null ? "" : data.classificationCodeText.replace(/<.*?>/g,"");//问题分类
            $api.dom('#checkResult').innerHTML = data.checkResult == null ? "" : data.checkResult.replace(/<.*?>/g,"");//检查内容
            $api.dom('#title').innerHTML = data.title == null ? "" : data.title;//安全隐患
            $api.dom('#noticeTypeText').innerHTML = data.noticeTypeText == null ? "" : data.noticeTypeText.replace(/<.*?>/g,"");//通知书类型
            $api.dom('#f5').innerHTML = data.f5 == null ? "" : data.f5.replace(/<.*?>/g,"");//通知书编号
            $api.dom('#rectifyTime').innerHTML = data.rectifyTime == null ? "" : new Date(data.rectifyTime).Format("yyyy-MM-dd");//限期整改时间
            $api.dom('#rectifyOpinion').innerHTML = data.rectifyOpinion == null ? "" : data.rectifyOpinion.replace(/<.*?>/g,"");//整改措施/要求

            // 设置图片高、宽度
            var imgData = data.imgs;
            for(let i=0; imgData != null && i<imgData.length; i++) {
                imgData[i].wh = widthAndHeight;
            }
            // 渲染安全整改隐患图片
            var interText = doT.template($api.dom("#imgDot").innerHTML);
            $api.dom('#imgDiv').innerHTML = interText(imgData);
            $api.dom('#imgDiv').innerHTML += "<div class='clear'></div>";
        });
    }
</script>
</body>

</html>